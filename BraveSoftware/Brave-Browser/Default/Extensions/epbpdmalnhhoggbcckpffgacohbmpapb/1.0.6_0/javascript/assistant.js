!function(e){!function(e){function t(e,t){return(t=t||document).querySelector(e)}e.create=function(e,n){var r=document.createElement("div");!function e(t,n){var r;null!=n&&(r="string"==typeof n?document.createTextNode(n):"svg"===n.tag?document.createElementNS("http://www.w3.org/2000/svg","svg"):"http://www.w3.org/1999/xhtml"===t.namespaceURI?document.createElement(n.tag):document.createElementNS(t.namespaceURI,n.tag),"object"==typeof n&&(n.attrs&&Object.keys(n.attrs).forEach((function(e){var t=n.attrs[e];null!=t&&!1!==t&&r.setAttribute(e,!0===t?"":String(t))})),n.children&&n.children.forEach((function(t){e(r,t)}))),t.appendChild(r))}(r,e);var o=r.firstElementChild;for(var i in n){var s=t(i,o);if(!s)throw new Error('Selector "'+i+"\" didn't return anything.");(0,n[i])(s)}return o},e.select=t,e.remove=function(e){return e.parentNode?e.parentNode.removeChild(e):e}}(e.Dom||(e.Dom={}))}(xp||(xp={})),function(e){!function(t){!function(e){e[e.Log=1]="Log",e[e.Info=2]="Info",e[e.Warn=4]="Warn",e[e.Error=8]="Error"}(t.HeatLevel||(t.HeatLevel={}));var n=t.HeatLevel;!function(e){e[e.Misc=16]="Misc",e[e.Binding=32]="Binding",e[e.UI=64]="UI",e[e.Test=128]="Test"}(t.Domain||(t.Domain={}));var r=t.Domain;t.DisplayMessages=n.Info|n.Warn|n.Error|r.Misc|r.Binding|r.UI|r.Test,t.write=function(r,o,i){for(var s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];if((o&t.DisplayMessages)>0&&(r&t.DisplayMessages)>0){if("string"==typeof i){s.unshift(i);e.formatString.apply(null,s)}else i;switch(r){case n.Log:case n.Info:case n.Warn:case n.Error:break;default:throw new Error("Not implemented.")}}},window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.console.info||(window.console.info=function(){}),window.console.warn||(window.console.warn=function(){}),window.console.error||(window.console.error=function(){})}(e.Log||(e.Log={}))}(xp||(xp={})),function(e){e.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=e,o=0;o<t.length;o++)r=r.replace(new RegExp("\\{"+o+"\\}","gm"),t[o]);return r},e.clone=function(t){var n=[],r=[],o=function(t){var i=n.indexOf(t);if(i>=0)return r[i];var s=typeof t;if(null===t||"string"===s||"boolean"===s||"number"===s||"undefined"===s||"function"===s)return t;if(t instanceof Object){var a;if(t instanceof Date){var l=new Date;l.setDate(t.getTime()),a=l}else if(t instanceof Array){for(var c=[],p=0;p<t.length;p++)c[p]=o(t[p]);a=c}else if(t instanceof e.ObservableCollection){var h=new e.ObservableCollection;for(p=0;p<t.length;p++)h.push(o(t[p]));a=h}else if(t instanceof e.ObservableObject){var u={};for(var d in t)u[d]=o(t[d]);a=e.observable(u)}else if(t instanceof Node)a=t.cloneNode(!0);else{var f=new(0,Object.getPrototypeOf(t).constructor);for(var d in t)t.hasOwnProperty(d)&&(f[d]=o(t[d]));a=f}return n.push(t),r.push(a),a}throw new Error("Item type is not supported for cloning.")};return o(t)},e.createUuid=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},e.getClassName=function(e){var t=/function\s+(.+?)\s*\(/.exec(e.constructor.toString());return t&&t.length>1?t[1]:""},e.applyConstructor=function(e,t){return new(e.bind.apply(e,[null].concat(t)))},e.hidePrototypeProperties=function(e,t){var n=e.prototype;for(var r in n)if(!t||0===t.length||t.indexOf(r)>=0){var o=Object.getOwnPropertyDescriptor(n,r);o&&o.configurable&&(o.enumerable=!1,Object.defineProperty(n,r,o))}}}(xp||(xp={})),function(e){!function(t){function n(e,t,n){if(void 0===n&&(n=!0),e){if(""===(t=t.replace(/\[(.+)\]/g,".$1")))return e;var r=t.split("."),o=e;return r.every((function(e){if(null==o){if(n)throw new Error('Unable to get property by path "'+t+'".');return!1}return o=o[e],!0})),o}if(n)throw new Error('Unable to get property by path "'+t+'".')}function r(e){var t=(e=e.replace(/\[(.+)\]/g,".$1")).match(/^(.*)\.[^\.]*$/);return t&&t[1]?t[1]:""}function o(e){var t=(e=e.replace(/\[(.+)\]/g,".$1")).match(/(^.*\.)?([^\.]*)$/);return t&&t[2]?t[2]:""}t.getPropertyByPath=n,t.setPropertyByPath=function(t,i,s,a){void 0===a&&(a=!0),t=n(t,r(i),a);var l=o(i);if(!(l in t)&&a)throw new Error(e.formatString('Unable to set property value "{0}" by path "{1}". Property is unreachable.',s,i));t[l]=s},t.getObjectPath=r,t.getPropertyName=o,t.replaceIndexers=function(t){return t.replace(i,(function(n,r){if(!s.test(r))throw new Error(e.formatString('Wrong property identifier. Property: "{0}". Path: "{1}".',t,r));return"."+r}))};var i=/\[(.+?)\]/g,s=/^[0-9A-Z_$]*$/i}(e.Path||(e.Path={}))}(xp||(xp={})),function(e){var t=function(){function e(e){this.pairs=e||[]}return e.prototype.get=function(e){var t=this.pairs.filter((function(t){return t.key===e}));return t.length>0?t[0].value:void 0},e.prototype.set=function(e,t){var n=this.pairs.filter((function(t){return t.key===e}));n.length>0?void 0===t?this.pairs.splice(this.pairs.indexOf(n[0]),1):n[0].value=t:this.pairs.push({key:e,value:t})},e.prototype.remove=function(e){var t=this.pairs.filter((function(t){return t.key===e}));t.length>0&&this.pairs.splice(this.pairs.indexOf(t[0]),1)},e}();e.Dictionary=t}(xp||(xp={})),function(e){var t=function(){function e(){this.handlers=[]}return e.prototype.addHandler=function(e,t){var n={event:this,handler:e,scope:t};if(this.handlers.filter((function(t){return t.handler===e}))[0])throw new Error("Duplicate subscription.");return this.handlers.push(n),n},e.prototype.removeHandler=function(e){var t=this.handlers.filter((function(t){return t.handler===e}))[0];if(!t)throw new Error("Unable to remove event handler :\n"+e.toString());return this.handlers.splice(this.handlers.indexOf(t),1),t.handler},e.prototype.removeAllHandlers=function(){this.handlers=[]},e.prototype.hasHandler=function(e){return this.handlers.filter((function(t){return t.handler===e})).length>0},e.prototype.invoke=function(e){this.handlers.forEach((function(t){t.handler.call(t.scope,e)}))},e}();e.Event=t;var n=function(){function e(){this.subscriptions=[]}return e.prototype.subscribe=function(e,t,n){var r=e.addHandler(t,n);return this.subscriptions.push(r),r},e.prototype.unsubscribe=function(e){for(var t;(t=this.subscriptions.indexOf(this.subscriptions.filter(e)[0]))>=0;){var n=this.subscriptions[t];n.event.removeHandler(n.handler),this.subscriptions.splice(t,1)}},e.prototype.unsubscribeAll=function(){this.subscriptions.forEach((function(e){e.event.removeHandler(e.handler)})),this.subscriptions=[]},e}();e.EventRegistrar=n}(xp||(xp={})),function(e){function t(e){return e&&"object"==typeof e&&"onPropertyChanged"in e}e.isNotifier=t;var n=function(){function n(e,t){void 0===t&&(t=!0),this.__initProperties__(),this.__convertNested__=t,e&&this.__copySource__(e)}return n.prototype.__initProperties__=function(){Object.defineProperty(this,"onPropertyChanged",{configurable:!0,value:new e.Event}),Object.defineProperty(this,"__convertNested__",{configurable:!0,writable:!0,value:!0})},n.prototype.__copySource__=function(e){if(e instanceof n)throw new Error("Source object is already observable.");if(Array.isArray(e))throw new Error("Source must not be an array. Use ObservableCollection.");if(!(e instanceof Object))throw new Error("Source must be an object.");for(var t in e)n.extend(this,t,e[t],this.__convertNested__)},n.isConvertable=function(e){return!("object"!=typeof e||t(e)||null===e||e instanceof Date)},n.extend=function(t,r,o,i){if(void 0===i&&(i=!0),r in t)throw new Error('Unable to create notification property. Object already has "'+r+'" property.');if("onPropertyChanged"===r)throw new Error('Unable to create notification property. Reserved name "'+r+'" is used.');if(o instanceof Date){var s=new Date;s.setTime(o.getTime()),o=s}if(i&&n.isConvertable(o)){o=e.observable(o);var a=function(i){n.isConvertable(i)&&(i=e.observable(i)),o=i,t.onPropertyChanged.invoke(r)}}else a=function(e){o=e,t.onPropertyChanged.invoke(r)};Object.defineProperty(t,r,{get:function(){return o},set:a,enumerable:!0,configurable:!0})},n}();e.ObservableObject=n,e.hidePrototypeProperties(n)}(xp||(xp={}));var xp,__extends=this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r};Object.defineProperties(Array.prototype,{move:{value:function(e,t){if(e<0&&(e=this.length+e),t<0&&(t=this.length+t),e>this.length-1||t>this.length-1||e<0||t<0)throw new Error("Index was out of range.");var n=this.splice(e,1)[0];return this.splice(t,0,n),this}},attach:{value:function(e,t){return this.splice(t,0,e),this.length}},detach:{value:function(e){return this.splice(e,1)[0]}}}),function(e){!function(e){e[e.Create=0]="Create",e[e.Replace=1]="Replace",e[e.Delete=2]="Delete",e[e.Move=3]="Move",e[e.Attach=4]="Attach",e[e.Detach=5]="Detach"}(e.CollectionChangeAction||(e.CollectionChangeAction={}));var t=e.CollectionChangeAction;e.isCollectionNotifier=function(e){return e&&"object"==typeof e&&"onCollectionChanged"in e};var n=function(n){function r(e,t){void 0===t&&(t=!0),n.call(this,e,t)}return __extends(r,n),r.prototype.__initProperties__=function(){var t=this;n.prototype.__initProperties__.call(this);var r=function(e,n,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!!r,value:n})};r("onCollectionChanged",new e.Event),r("inner",[],!0),r("sorting",!1,!0),r("splicing",!1,!0)},r.prototype.__copySource__=function(e){var t=this;if(e&&(!Array.isArray(e)||e instanceof r))throw new Error("Source must be an array.");e&&e.forEach((function(e,n){t.add(e,n)}))},r.prototype.add=function(e,n,r){if(e=this.createNotifierIfPossible(e),this.inner.splice(n,0,e),this.appendIndexProperty(),this.onCollectionChanged.invoke({action:r?t.Attach:t.Create,newIndex:n,newItem:e}),this.onPropertyChanged.invoke("length"),!this.__splicing__)for(var o=n;o<this.inner.length;o++)this.onPropertyChanged.invoke(o.toString())},r.prototype.remove=function(e,n){var r=this.inner.splice(e,1)[0];if(this.deleteIndexProperty(),this.onCollectionChanged.invoke({action:n?t.Detach:t.Delete,oldIndex:e,oldItem:r}),this.onPropertyChanged.invoke("length"),!this.__splicing__)for(var o=e;o<this.inner.length+1;o++)this.onPropertyChanged.invoke(o.toString());return r},r.prototype.appendIndexProperty=function(){var e=this,n=this.inner.length-1;Object.defineProperty(this,n.toString(),{get:function(){return e.inner[n]},set:function(r){r=e.createNotifierIfPossible(r),e.onCollectionChanged.invoke({action:t.Replace,oldIndex:n,newIndex:n,oldItem:e.inner[n],newItem:e.inner[n]=r}),e.onPropertyChanged.invoke(n.toString())},enumerable:!0,configurable:!0})},r.prototype.deleteIndexProperty=function(){delete this[this.inner.length]},r.prototype.createNotifierIfPossible=function(t){return this.__convertNested__&&e.ObservableObject.isConvertable(t)&&(t=e.observable(t)),t},Object.defineProperty(r.prototype,"length",{get:function(){return this.inner.length},enumerable:!0,configurable:!0}),r.prototype.move=function(e,n){if(this.inner.move(e,n),this.onCollectionChanged.invoke({action:t.Move,oldIndex:e,newIndex:n,oldItem:this.inner[n],newItem:this.inner[n]}),!this.__sorting__)for(var r=Math.min(e,n);r<=Math.max(e,n);r++)this.onPropertyChanged.invoke(r.toString());return this.inner},r.prototype.attach=function(e,t){return this.add(e,t,!0),this.inner.length},r.prototype.detach=function(e){return this.remove(e,!0)},r.prototype.pop=function(){return this.remove(this.inner.length-1)},r.prototype.push=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return t.forEach((function(t){e.add(t,e.inner.length)})),this.inner.length},r.prototype.reverse=function(){this.__sorting__=!0;for(var e=this.inner.length,t=0;t<e-1;t++)this.move(0,e-1-t);this.__sorting__=!1;for(t=0;t<e;t++)e%2==1&&Math.floor(e/2)===t||this.onPropertyChanged.invoke(t.toString());return this.inner},r.prototype.shift=function(){return this.remove(0)},r.prototype.sort=function(e){var t=this,n=this.inner.slice(),r=n.slice().sort(e),o=n.map((function(e,t){return{old:t,new:r.indexOf(e)}}));o.sort((function(e,t){return t.new-e.new}));for(var i=0;i<o.length;i++)for(var s=i+1;s<o.length;s++)o[i].old<o[s].old&&o[s].old--;return this.__sorting__=!0,o.forEach((function(e){return e.old!==e.new&&t.move(e.old,e.new)})),this.__sorting__=!1,o.forEach((function(e){e.new!==e.old&&t.onPropertyChanged.invoke(e.new.toString())})),this.inner},r.prototype.splice=function(e,t){for(var n=this,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(void 0===e)throw new Error("The specified arguments may lead to unexpected result.");if(e<0&&(e=this.inner.length+e),e<0||e>this.inner.length||t<0)throw new Error("Index was out of range.");t=isNaN(t)?this.inner.length-e:t;var i=this.inner.length;this.__splicing__=!0;for(var s=new Array,a=0;a<t;a++){var l=this.remove(e);s.push(l)}if(r){var c=e;r.forEach((function(e){n.add(e,c),c++}))}this.__splicing__=!1;var p=r?r.length:0,h=this.inner.length,u=t===p?e+p:Math.max(h,i);for(a=e;a<u;a++)this.onPropertyChanged.invoke(a.toString());return s},r.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.splice(0,0,e.length>1?e:e[0]),this.inner.length},r.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.inner.concat.apply(this.inner,arguments)},r.prototype.join=function(e){return this.inner.join.apply(this.inner,arguments)},r.prototype.slice=function(e,t){return this.inner.slice.apply(this.inner,arguments)},r.prototype.toJSON=function(){return this.inner},r.prototype.toString=function(){return Object.prototype.toString.call(this)},r.prototype.toLocaleString=function(){return this.inner.toLocaleString()},r.prototype.indexOf=function(e,t){return this.inner.indexOf.apply(this.inner,arguments)},r.prototype.lastIndexOf=function(e,t){return this.inner.lastIndexOf.apply(this.inner,arguments)},r.prototype.forEach=function(e,t){return this.inner.forEach.apply(this.inner,arguments)},r.prototype.every=function(e,t){return this.inner.every.apply(this.inner,arguments)},r.prototype.some=function(e,t){return this.inner.some.apply(this.inner,arguments)},r.prototype.filter=function(e,t){return this.inner.filter.apply(this.inner,arguments)},r.prototype.map=function(e,t){return this.inner.map.apply(this.inner,arguments)},r.prototype.reduce=function(e,t){return this.inner.reduce.apply(this.inner,arguments)},r.prototype.reduceRight=function(e,t){return this.inner.reduceRight.apply(this.inner,arguments)},r}(e.ObservableObject);e.ObservableCollection=n,e.hidePrototypeProperties(n)}(xp||(xp={})),function(e){e.observable=function(t,n){if(void 0===n&&(n=!0),e.isNotifier(t))throw new Error("Source object is already observable.");if("object"!=typeof t)throw new Error("Source must be an object.");if(t instanceof Date)throw new Error("Dates cannot be converted into an observable.");return Array.isArray(t)?new e.ObservableCollection(t,n):new e.ObservableObject(t,n)}}(xp||(xp={})),function(e){var t=function(){function t(t,r){var o=this;this.sourceSetToken=!1,this.scope=r,Object.defineProperty(this,"onPropertyChanged",{value:new e.Event});var i=t.match(/\{([^\s\(\)]+?)\}/g),s=[];if(i)for(var a=0;a<i.length;a++){var l=i[a].replace("{","").replace("}","");if(""===l)throw new Error('Empty path binding for expression is not supported. Expression: "'+t+'"');s.indexOf(l)<0&&s.push(l)}this.propsPaths=s;var c=t,p=[];this.params={onPropertyChanged:new e.Event},this.collectionRegistrations={},s.forEach((function(t,n){var r="p"+n;c=c.split("{"+t+"}").join(r),p.push(r);var i="_"+r;o.params[i]=null,Object.defineProperty(o.params,r,{get:function(){return o.params[i]},set:function(t){if(o.collectionRegistrations[r]&&(o.collectionRegistrations[r].unsubscribeAll(),delete o.collectionRegistrations[r]),void 0!==t&&e.isCollectionNotifier(t)){var n=new e.EventRegistrar,s=t;n.subscribe(s.onCollectionChanged,(function(e){o.exec()}),o),o.collectionRegistrations[r]=n}o.params[i]=t,o.sourceSetToken||o.exec()},enumerable:!0,configurable:!0})})),this.func=function(){for(var e={},t=0;t<arguments.length;t++)e["p"+t]=arguments[t];var r=n(c,e);return r},this.managers=[],this.propsPaths.forEach((function(t,n){var r=new e.BindingManager(o.params,p[n],o.scope,t);o.managers.push(r)})),this.exec()}return Object.defineProperty(t.prototype,"result",{get:function(){return this.resultField},set:function(e){this.resultField=e,this.onPropertyChanged.invoke("result")},enumerable:!0,configurable:!0}),t.prototype.exec=function(){var t=[];for(var n in this.params)if("p"===n[0]){var r=this.params[n];r instanceof e.ObservableCollection&&(r=r.slice()),t.push(r)}try{this.resultField=this.func.apply(null,t)}catch(t){e.Log.write(e.Log.HeatLevel.Warn,e.Log.Domain.Binding,"Expression error: "+t),this.resultField=null}this.onPropertyChanged.invoke("result")},t.prototype.resetWith=function(e){this.sourceSetToken=!0,this.scope=e,this.managers.forEach((function(t){t.resetWith(e)})),this.sourceSetToken=!1,this.exec()},t.prototype.unbind=function(){this.managers.forEach((function(e){return e.unbind()})),this.onPropertyChanged.removeAllHandlers()},t}();function n(t,n){var r=function(e){for(var t;t!==e;)t=e,e=e.replace(/\([^\(\)]*\)/g,(function(e){return new Array(e.length+1).join(" ")}));return e},o=function(e){var t=e.replace(/((".*?")|('.*?'))/g,(function(e,t){return new Array(t.length+1).join(" ")})),n=(t=r(t)).indexOf(this.op);return n<0?null:[e.slice(0,n),e.slice(n+this.op.length,e.length)]},i=function(e){var t=e.replace(/((".*?")|('.*?'))/g,(function(e,t){return new Array(t.length+1).join(" ")})),n=(t=r(t)).indexOf(this.op);return n<0?null:[e.slice(n+this.op.length,e.length)]},s=[{op:"?:",fn:function(e,t,n){return e?t:n},split:function(e){var t=e.replace(/((".*?")|('.*?'))/g,(function(e,t){return new Array(t.length+1).join(" ")})),n=(t=r(t)).indexOf(this.op[0]);if(n<0)return null;var o=t.indexOf(this.op[1],n+1);return o<0?null:[e.slice(0,n),e.slice(n+1,o),e.slice(o+1,e.length)]}},{op:"||",fn:function(e,t){return e||t},split:o},{op:"&&",fn:function(e,t){return e&&t},split:o},{op:"!==",fn:function(e,t){return e!==t},split:o},{op:"===",fn:function(e,t){return e===t},split:o},{op:"!=",fn:function(e,t){return e!=t},split:o},{op:"==",fn:function(e,t){return e==t},split:o},{op:">=",fn:function(e,t){return e>=t},split:o},{op:">",fn:function(e,t){return e>t},split:o},{op:"<=",fn:function(e,t){return e<=t},split:o},{op:"<",fn:function(e,t){return e<t},split:o},{op:"-",fn:function(e,t){return e-t},split:o},{op:"+",fn:function(e,t){return e+t},split:o},{op:"/",fn:function(e,t){return e/t},split:o},{op:"*",fn:function(e,t){return e*t},split:o},{op:"typeof",fn:function(e){return typeof e},split:i},{op:"!",fn:function(e){return!e},split:i}],a=function(t,r){if(t=t.trim(),void 0===r&&(r=0),r===s.length){if("("===t[0]&&")"===t[t.length-1])return a(t.slice(1,t.length-1),0);if("true"===t)return!0;if("false"===t)return!1;var o=+t;if(""!==t&&!isNaN(o))return o;if(/^(".*")|('.*')$/.test(t))return t.slice(1,t.length-1);if(t in n)return n[t];if(t in window)return window[t];var i=t.indexOf(".");if(i>=0){var l=t.slice(0,i);if(!(l in n)&&!(l in window))throw new Error("Expression scope doesn't contain \""+l+'".');var c,p=l in n?n[l]:window[l],h=t.slice(i+1,t.length),u=e.Path.getObjectPath(h),d=e.Path.getPropertyByPath(p,u,!1);if("object"!=typeof d||null===d)return void e.Log.write(e.Log.HeatLevel.Info,e.Log.Domain.Binding,"Unable to execute expression: Item supposed to be an object.");if((c=(m=e.Path.getPropertyName(h)).match(/\((.*)\)$/))&&c[1]){m=m.slice(0,c.index);var f=c[1].split(",").map((function(e){return a(e)}));return d[m].apply(d,f)}return d[m]}if((c=t.match(/\((.*)\)$/))&&c[1]){var m=t.slice(0,c.index);f=c[1].split(",").map((function(e){return a(e)}));return d[m].apply(d,f)}throw new Error("Expression scope doesn't contain \""+t+'".')}var g=s[r],v=g.split(t);if(v){for(var y=[],b=0;b<v.length;b++){var E=a(v[b],r);y.push(E)}return g.fn.apply(null,y)}return a(t,r+1)};return a(t)}e.Expression=t,e.hidePrototypeProperties(t),e.evaluate=n}(xp||(xp={})),function(e){var t=function(){function t(t,n,r,o,i){if(!n)throw new Error("Target property path is not set.");if(!o)throw new Error("Unable to bind to empty path.");if(this.target=t,this.targetPropertyPath=n,this.scope=r,this.path=o,this.defaultValue=i,this.pathParts=e.Path.replaceIndexers(o).split("."),!this.pathParts||this.pathParts.length<1)throw new Error(e.formatString('Wrong binding path: "{0}".',o));this.pathParts.forEach((function(t){if(""===t)throw new Error(e.formatString('Unable to bind to empty path. Path: "{0}".',o))})),this.registerPathObjects(),this.updateTarget()}return t.prototype.registerPathObjects=function(t){var n=this;if(void 0===t&&(t=0),this.pathObjects){for(var r=this.pathObjects,o=t;o<r.length-1;o++)e.isNotifier(r[o].obj)&&r[o].obj.onPropertyChanged.removeHandler(r[o].handler);this.pathObjects.splice(t,r.length-t)}var i=this.pathParts;0===t&&(this.pathObjects=[]),this.pathObjects[t]={obj:0===t?this.scope:e.Path.getPropertyByPath(this.scope,i.slice(0,t).join("."))};for(r=this.pathObjects,o=t;o<i.length;o++){var s=i[o];r[o].prop=s;var a,l=r[o].obj;if(!l)break;if(r[o+1]={obj:l[s]},e.isNotifier(l))a=o==i.length-1?function(e){return function(t){t===e&&n.updateTarget()}}(s):function(e,t){return function(r){r===e&&(n.registerPathObjects(t),n.updateTarget())}}(s,o+1),r[o].obj.onPropertyChanged.addHandler(a,this),r[o].handler=a}this.pathObjects=r},t.prototype.resetWith=function(t){this.logMessage(e.formatString('Reset with "{0}".',this.scope)),this.scope=t,this.registerPathObjects(),this.updateTarget()},t.prototype.updateSource=function(){var t=e.Path.getPropertyByPath(this.target,this.targetPropertyPath),n=this.pathParts.length,r=this.pathObjects[n-1].obj;"object"==typeof r&&null!==r?(this.logMessage(e.formatString('Update source "{0}" property with value "{1}".',this.path,t)),r[this.pathParts[n-1]]=t):this.logMessage(e.formatString('Unable to update source property "{0}". It is unreachable.',this.path))},t.prototype.updateTarget=function(){var t=e.Path.getPropertyByPath(this.scope,this.path,!1),n=e.Path.getObjectPath(this.targetPropertyPath),r=e.Path.getPropertyName(this.targetPropertyPath),o=e.Path.getPropertyByPath(this.target,n);null!=t?(this.logMessage(e.formatString('Update target with "{0}" property value "{1}".',this.path,t)),o[r]=t):(this.logMessage(e.formatString('Unable to reach value "{0}". Using default value "{1}".',this.path,this.defaultValue)),o[r]=this.defaultValue)},t.prototype.unbind=function(){if(this.logMessage("Unbind."),this.pathObjects)for(var t=this.pathObjects,n=0;n<t.length-1;n++)e.isNotifier(t[n].obj)&&t[n].obj.onPropertyChanged.removeHandler(t[n].handler)},t.prototype.logMessage=function(t){e.Log.write(e.Log.HeatLevel.Log,e.Log.Domain.Binding,'BM of "{0}#{1}.{2}": {3}',e.getClassName(this.target),this.target.name,this.targetPropertyPath,t)},t}();e.BindingManager=t}(xp||(xp={})),function(e){var t=function(e){function t(t,n,r,o,i){var s;e.call(this,(s={},Object.defineProperty(s,"result",{set:function(e){r(e)},get:function(){if(o)return o()}}),s),"result",t,n,i)}return __extends(t,e),t}(e.BindingManager);e.BindingCallManager=t}(xp||(xp={})),function(e){var t=function(){function t(){Object.defineProperty(this,"onPropertyChanged",{enumerable:!1,configurable:!0,writable:!1,value:new e.Event})}return t.property=function(t,n,r,o){var i=(o=o||{}).convertToObservable||e.isNotifier(r),s=o.convertNested||r instanceof e.ObservableObject&&r.__convertNested__;if(void 0===o.enumerable&&(o.enumerable=!0),o.getterConvertor)var a=o.getterConvertor,l=function(){return a(r)};else l=function(){return r};if(o.setterConvertor){var c=o.setterConvertor;if(i)var p=function(o){e.ObservableObject.isConvertable(o)&&(o=e.observable(o,s)),r=c(o),t.onPropertyChanged.invoke(n)};else p=function(e){r=c(e),t.onPropertyChanged.invoke(n)}}else if(i)p=function(o){e.ObservableObject.isConvertable(o)&&(o=e.observable(o,s)),r=o,t.onPropertyChanged.invoke(n)};else p=function(e){r=e,t.onPropertyChanged.invoke(n)};Object.defineProperty(t,n,{get:l,set:p,configurable:!0,enumerable:o.enumerable})},t.nonEnumerableField=function(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})},t}();e.Model=t,e.property=function(t){return t=t||{},function(n,r){var o=t.convertToObservable,i=t.convertNested,s=void 0===t.enumerable||t.enumerable,a="_"+r;if(t.getterConvertor)var l=t.getterConvertor,c=function(){return l(this[a])};else c=function(){return this[a]};if(t.setterConvertor){var p=t.setterConvertor;if(o)var h=function(t){e.ObservableObject.isConvertable(t)&&(t=e.observable(t,i)),this[a]=p(t),this.onPropertyChanged.invoke(r)};else h=function(e){this[a]=p(e),this.onPropertyChanged.invoke(r)}}else if(o)h=function(t){e.ObservableObject.isConvertable(t)&&(t=e.observable(t,i)),this[a]=t,this.onPropertyChanged.invoke(r)};else h=function(e){this[a]=e,this.onPropertyChanged.invoke(r)};Object.defineProperty(n,r,{get:c,set:h,configurable:!0,enumerable:s}),Object.defineProperty(n,a,{writable:!0,configurable:!0})}}}(xp||(xp={})),function(e){var t=function(){function t(t,n){var r=this;Object.defineProperty(this,"onPropertyChanged",{value:new e.Event}),Object.defineProperty(this,"__registrar__",{value:new e.EventRegistrar});var o=[],i=!1,s=function(e){Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get:function(){return t[e]},set:function(n){i=!0,t[e]=n,i=!1,r.onPropertyChanged.invoke(e)}}),o.push(e)};for(var a in t)s(a);if(e.isNotifier(t)&&this.__registrar__.subscribe(t.onPropertyChanged,(function(e){i||(o.indexOf(e)<0&&s(e),r.onPropertyChanged.invoke(e))}),this),n){var l=[],c=function(e){Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get:function(){return n[e]},set:function(t){i=!0,n[e]=t,i=!1,r.onPropertyChanged.invoke(e)}}),l.push(e)};for(var a in n)o.indexOf(a)<0&&c(a);e.isNotifier(n)&&this.__registrar__.subscribe(n.onPropertyChanged,(function(e){!i&&o.indexOf(e)<0&&(l.indexOf(e)<0&&c(e),r.onPropertyChanged.invoke(e))}),this)}}return t.prototype.unsubscribeScopeFromChanges=function(){this.__registrar__.unsubscribeAll()},t}();e.Scope=t,e.hidePrototypeProperties(t)}(xp||(xp={})),function(e){e.serialize=function(t,n,r,o){return void 0===n&&(n=!0),void 0===o&&(o=" "),JSON.stringify(t,(function(t,o){return n&&null!==o&&"object"==typeof o&&!Array.isArray(o)&&Object.getPrototypeOf(o)!==Object&&(o.__xp_model__=e.getClassName(o)),r&&(o=r(t,o)),o}),o)},e.deserialize=function(t,n,r){var o={};return n&&n.forEach((function(e){var t=e.toString().match(/^function\s*(.*?)\s*\(/)[1];if(t in o)throw new Error('Duplicate model name: "'+t+'".');o[t]=e})),JSON.parse(t,(function(t,n){if(r&&(n=r(t,n)),"object"==typeof n&&null!==n&&"__xp_model__"in n){if("ObservableObject"===n.__xp_model__||"ObservableCollection"===n.__xp_model__)return delete n.__xp_model__,e.observable(n);var i=o[n.__xp_model__];if(!i)throw new Error('No costructor specified for model "'+n.__xp_model__+'".');var s=new i;for(var a in n)"__xp_model__"!==a&&(s[a]=n[a]);return s}return n}))}}(xp||(xp={})),function(e){e.createEventArgs=function(e,t){var n=e.domElement.getBoundingClientRect(),r={domEvent:t,element:e};return"pageX"in t&&(r.elementX=t.pageX-n.left),"pageY"in t&&(r.elementY=t.pageY-n.top),r}}(xp||(xp={})),function(e){var t=function(t){function n(e){var n=this;t.call(this),this.__isRendered__=!1,this.parentScopeChangeHandler=function(){if(n.useParentScope){var e=n.bindings.get("scope");e?e.resetWith(n.parent.scope):n.scope=n.parent.scope}},this.useParentScope=!0,this.initElement(),e&&this.applyMarkup(e),this.init&&this.init(this)}return __extends(n,t),n.prototype.initElement=function(){this.defineProperties(),this.domElement=this.getTemplate(),this.initEvents(),this.setDefaults()},n.prototype.getTemplate=function(){throw new Error("Unable to create an instance of an abstract element.")},n.prototype.renderTo=function(e){e.parentElement.replaceChild(this.domElement,e),this.__setRenderedState__(!0)},n.prototype.__setRenderedState__=function(e){this.__isRendered__=e,e&&this.onRendered&&this.onRendered.invoke(this)},n.prototype.initEvents=function(){var t=this;this.bindings=new e.Dictionary,this.expressions=new e.Dictionary,this.onScopeChanged=new e.Event,this.onRendered=new e.Event,this.onClick=new e.Event,this.onDoubleClick=new e.Event,this.onMouseDown=new e.Event,this.onMouseUp=new e.Event,this.onMouseMove=new e.Event,this.onMouseEnter=new e.Event,this.onMouseLeave=new e.Event,this.onKeyPress=new e.Event,this.onKeyDown=new e.Event,this.onKeyUp=new e.Event,this.onRemoved=new e.Event,this.onRemoved.addHandler((function(){t.onScopeChanged.removeAllHandlers(),t.onRendered.removeAllHandlers(),t.onClick.removeAllHandlers(),t.onDoubleClick.removeAllHandlers(),t.onMouseDown.removeAllHandlers(),t.onMouseUp.removeAllHandlers(),t.onMouseMove.removeAllHandlers(),t.onMouseEnter.removeAllHandlers(),t.onMouseLeave.removeAllHandlers(),t.onKeyPress.removeAllHandlers(),t.onKeyDown.removeAllHandlers(),t.onKeyUp.removeAllHandlers()}),this),this.initSimpleDomEvent("click",this.onClick),this.initSimpleDomEvent("dblclick",this.onDoubleClick),this.initSimpleDomEvent("mousedown",this.onMouseDown),this.initSimpleDomEvent("mouseup",this.onMouseUp),this.initSimpleDomEvent("mousemove",this.onMouseMove),this.initSimpleDomEvent("mouseover",this.onMouseEnter),this.initSimpleDomEvent("mouseout",this.onMouseLeave),this.initSimpleDomEvent("keypress",this.onKeyPress),this.initSimpleDomEvent("keydown",this.onKeyDown),this.initSimpleDomEvent("keyup",this.onKeyUp)},n.prototype.initSimpleDomEvent=function(t,n){var r=this;this.domElement.addEventListener(t,(function(t){var o=e.createEventArgs(r,t);n.invoke(o)}))},n.prototype.applyMarkup=function(t){for(var n in t){var r=t[n];if("string"==typeof r){var o=r.match(/^\{(.*)\}$/),i=r.match(/^\((.*)\)$/);o&&o[1]?this.bind(n,o[1]):i&&i[1]?this.express(n,i[1]):this[n]=r}else this[n]instanceof e.Event?this[n].addHandler(t[n],this):this[n]=r}},n.prototype.defineProperty=function(t,n){var r,o=this;Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:function(){return n.getter?n.getter():r},set:function(i){if(n.acceptedValues&&n.acceptedValues.indexOf(i)<0)throw new Error(e.formatString('The value "{0}" is not accepted for a {1}. List of accepted values: {2}.',i,e.getClassName(o),n.acceptedValues.join(", ")));n.setter&&n.setter(i),r=i,n.observable&&o.onPropertyChanged.invoke(t)}})},n.prototype.defineProperties=function(){var e=this;this.defineProperty("enabled",{setter:function(t){t?(e.domElement.classList.remove("disabled"),e.domElement.style.pointerEvents=""):(e.domElement.classList.add("disabled"),e.domElement.style.pointerEvents="none")},observable:!0}),this.defineProperty("name",{setter:function(t){return e.domElement.id=t},getter:function(){return e.domElement.id}}),this.defineProperty("key",{}),this.defineProperty("width",{setter:function(t){return e.domElement.style.width=t},getter:function(){return e.domElement.offsetWidth+"px"}}),this.defineProperty("height",{setter:function(t){return e.domElement.style.height=t},getter:function(){return e.domElement.offsetHeight+"px"}}),this.defineProperty("minWidth",{setter:function(t){return e.domElement.style.minWidth=t},getter:function(){return e.domElement.style.minWidth}}),this.defineProperty("minHeight",{setter:function(t){return e.domElement.style.minHeight=t},getter:function(){return e.domElement.style.minHeight}}),this.defineProperty("maxWidth",{setter:function(t){return e.domElement.style.maxWidth=t},getter:function(){return e.domElement.style.maxWidth}}),this.defineProperty("maxHeight",{setter:function(t){return e.domElement.style.maxHeight=t},getter:function(){return e.domElement.style.maxHeight}}),this.defineProperty("margin",{setter:function(t){return e.domElement.style.margin=t},getter:function(){return e.domElement.style.margin}});var t="";this.defineProperty("style",{getter:function(){return t},setter:function(n){t&&t.split(" ").forEach((function(t){return e.domElement.classList.remove(t)}));t=n,n.split(" ").forEach((function(t){return e.domElement.classList.add(t)}))}}),this.defineProperty("flex",{setter:function(t){switch(e.domElement.classList.remove("flex-None"),e.domElement.classList.remove("flex-Stretch"),e.domElement.classList.remove("flex-Grow"),e.domElement.classList.remove("flex-Shrink"),t){case"none":e.domElement.classList.add("flex-None");break;case"stretch":e.domElement.classList.add("flex-Stretch");break;case"grow":e.domElement.classList.add("flex-Grow");break;case"shrink":e.domElement.classList.add("flex-Shrink");break;default:throw new Error('Unknown flex value "'+t+'".')}},acceptedValues:["none","shrink","grow","stretch"]}),this.defineProperty("visible",{setter:function(t){t?e.domElement.classList.remove("hidden"):e.domElement.classList.add("hidden")},observable:!0})},n.prototype.setDefaults=function(){this.enabled=!0,this.visible=!0},Object.defineProperty(n.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),n.prototype.__setParent__=function(e){if(e&&e.children.indexOf(this)<0)throw new Error('The "parent" property must be set only by parent.');this._parent&&this._parent.onScopeChanged.removeHandler(this.parentScopeChangeHandler),this._parent=e,e&&(this._parent.onScopeChanged.addHandler(this.parentScopeChangeHandler,this),this.parentScopeChangeHandler(),!this.__isRendered__&&e.__isRendered__&&this.__setRenderedState__(!0))},n.prototype.remove=function(){this.detach(),this.bindings.pairs.forEach((function(e){return e.value.unbind()})),this.bindings.pairs.splice(0),this.expressions.pairs.forEach((function(e){return e.value.unbind()})),this.expressions.pairs.splice(0),e.Dom.remove(this.domElement),this.onRemoved.invoke(this),this.onRemoved.removeAllHandlers()},n.prototype.insertBefore=function(e){if(!e.parent)throw new Error("Target element has no parent.");var t;if(this.parent===e.parent){var n=this.parent.children.indexOf(this),r=this.parent.children.indexOf(e);t=n<r?r-1:r}else t=e.parent.children.indexOf(e);e.parent.insert(this,t)},n.prototype.insertAfter=function(e){if(!e.parent)throw new Error("Target element has no parent.");var t;if(this.parent===e.parent){var n=this.parent.children.indexOf(this),r=this.parent.children.indexOf(e);t=n<r?r:r+1}else t=e.parent.children.indexOf(e)+1;e.parent.insert(this,t)},n.prototype.appendTo=function(e){e.append(this)},n.prototype.prependTo=function(e){e.prepend(this)},n.prototype.detach=function(){this.parent&&this.parent.detachChild(this)},n.prototype.bubbleBy=function(e){for(var t=this;t;){if(!0==!!e(t))return t;t=t.parent}return null},n.prototype.focus=function(){this.domElement.focus()},n.prototype.bind=function(t,n,r,o){var i=this.bindings.get(t);if(i&&i.unbind(),""===t||""===n)throw new Error("Binding path cannot be empty.");if("scope"===t&&!this.useParentScope&&!r)throw new Error("Unable to bind element's scope to itself.");r||(this.useParentScope?this.parent&&(r=this.parent.scope):r=this.scope),"string"==typeof t?this.bindings.set(t,new e.BindingManager(this,t,r,n,o)):this.bindings.set(t,new e.BindingCallManager(r,n,t,null,o))},n.prototype.unbind=function(e){var t=this.bindings.get(e);t&&(t.unbind(),this.bindings.remove(e));var n=this.expressions.get(e);n&&(n.unbind(),this.expressions.remove(e))},n.prototype.express=function(t,n,r){var o=this,i=this.expressions.get(t);i&&i.unbind(),i=new e.Expression(n,r||this.scope),this.expressions.set(t,i),"string"==typeof t?this.bindings.set(t,new e.BindingManager(this,t,i,"result")):this.bindings.set(t,new e.BindingCallManager(i,"result",(function(e){return t(e,o)})))},Object.defineProperty(n.prototype,"scope",{get:function(){return this._scope},set:function(t){var n=this;this.bindings.get("scope")&&t!==this.parent.scope&&(t=new e.Scope(t,this.parent.scope)),e.Log.write(e.Log.HeatLevel.Log,e.Log.Domain.UI|e.Log.Domain.Binding,'{0}:{1}: Set data scope "{2}".',e.getClassName(this),this.name||"-",t),this._scope=t,this.bindings.pairs.forEach((function(e){var r=e.key,o=e.value;"scope"===r||n.expressions.get(r)||o.resetWith(t)})),this.expressions.pairs.forEach((function(e){var n=e.key,r=e.value;"scope"!==n&&r.resetWith(t)})),this.onScopeChanged.invoke(t)},enumerable:!0,configurable:!0}),n.prototype.onInput=function(t,n){e.Log.write(e.Log.HeatLevel.Log,e.Log.Domain.UI,'{0}:{1}.{2}: Input "{3}".',e.getClassName(this),this.name||"-",t,n),"string"==typeof t?e.Path.setPropertyByPath(this,t,n):t(n);var r=this.bindings.get(t);r&&r.updateSource()},n}(e.Model);e.Element=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){var t=this;return e.Dom.create({tag:"button",attrs:{class:"Button",type:"button"},children:[{tag:"span",attrs:{class:"wrapper"},children:[{tag:"span",attrs:{class:"icon"}},{tag:"span",attrs:{class:"text"}}]}]},{".icon":function(e){return t.iconElement=e},".text":function(e){return t.textElement=e}})},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.icon=null,this.text=""},n.prototype.defineProperties=function(){var n,r=this;t.prototype.defineProperties.call(this),this.defineProperty("icon",{setter:function(t){"string"==typeof t&&""!==t?(n&&("."===n[0]?r.iconElement.classList.remove(n.slice(1)):r.iconElement.style.backgroundImage=""),"*"!==(t=t.trim())&&("."===t[0]?r.iconElement.classList.add(t.slice(1)):r.iconElement.style.backgroundImage=e.formatString("url({0})",t),n=t),r.iconElement.classList.remove("hidden")):r.iconElement.classList.add("hidden")}}),this.defineProperty("text",{setter:function(e){!0==!!e?(r.textElement.textContent=e,r.textElement.classList.remove("hidden")):r.textElement.classList.add("hidden")}})},n}(e.Element);e.Button=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){var t=this;return e.Dom.create({tag:"label",attrs:{class:"CheckBox"},children:[{tag:"input",attrs:{type:"checkbox"}},{tag:"span",attrs:{class:"check"}},{tag:"label",attrs:{class:"text"}}]},{input:function(e){return t.checkElement=e},".text":function(e){return t.textElement=e}})},n.prototype.initEvents=function(){var n=this;t.prototype.initEvents.call(this),this.onCheckChange=new e.Event,this.onRemoved.addHandler((function(){return n.onCheckChange.removeAllHandlers()}),this),this.domElement.addEventListener("change",(function(t){if(!n.readonly){n.onInput("checked",n.checked);var r=e.createEventArgs(n,t);r.checked=n.checked,n.onCheckChange.invoke(r)}}))},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.checked=!1,this.readonly=!1,this.text=""},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("checked",{getter:function(){return e.checkElement.checked},setter:function(t){return e.checkElement.checked=t},observable:!0}),this.defineProperty("text",{setter:function(t){!0==!!t?(e.textElement.textContent=t,e.textElement.classList.remove("hidden")):e.textElement.classList.add("hidden")}}),this.defineProperty("readonly",{setter:function(t){t?(e.checkElement.readOnly=!0,e.domElement.style.pointerEvents="none"):(e.checkElement.readOnly=!1,e.domElement.style.pointerEvents="")}}),this.defineProperty("enabled",{setter:function(t){t?e.domElement.classList.remove("disabled"):e.domElement.classList.add("disabled"),!e.readonly&&t?(e.checkElement.readOnly=!1,e.domElement.style.pointerEvents=""):(e.checkElement.readOnly=!0,e.domElement.style.pointerEvents="none")},observable:!0})},n}(e.Element);e.CheckBox=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"label",attrs:{class:"Label"}})},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("text",{setter:function(t){e.domElement.textContent=t},observable:!0})},n}(e.Element);e.Label=t}(xp||(xp={})),function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"span",attrs:{class:"Placeholder"},children:["&nbsp;"]})},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this)},n}(e.Element);e.Placeholder=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){var t=this;return e.Dom.create({tag:"label",attrs:{class:"RadioButton"},children:[{tag:"input",attrs:{type:"radio"}},{tag:"span",attrs:{class:"check"}},{tag:"label",attrs:{class:"text"}}]},{input:function(e){return t.checkElement=e},".text":function(e){return t.textElement=e}})},n.prototype.initEvents=function(){var e=this;t.prototype.initEvents.call(this),this.onCheckChange.addHandler((function(t){t.checked&&e.onInput("selectedItem",e.item)}),this)},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("group",{getter:function(){return e.checkElement.name},setter:function(t){return e.checkElement.name=t}}),this.defineProperty("item",{setter:function(t){e.checked!=(t==e.selectedItem)&&(e.checked=t==e.selectedItem)},observable:!0}),this.defineProperty("selectedItem",{setter:function(t){e.checked!=(t==e.item)&&(e.checked=t==e.item)},observable:!0})},n}(e.CheckBox);e.RadioButton=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){var t=this;return e.Dom.create({tag:"label",attrs:{class:"ToggleButton"},children:[{tag:"input",attrs:{type:"radio"}},{tag:"span",attrs:{class:"icon"}},{tag:"label",attrs:{class:"text"}}]},{input:function(e){return t.checkElement=e},".icon":function(e){return t.iconElement=e},".text":function(e){return t.textElement=e}})},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.icon=null},n.prototype.defineProperties=function(){var n,r=this;t.prototype.defineProperties.call(this),this.defineProperty("checked",{getter:function(){return r.checkElement.checked},setter:function(e){r.checkElement.checked=e,e?r.domElement.classList.add("checked"):r.domElement.classList.remove("checked")},observable:!0}),this.defineProperty("icon",{setter:function(t){"string"==typeof t&&""!==t?(n&&("."===n[0]?r.iconElement.classList.remove(n.slice(1)):r.iconElement.style.backgroundImage=""),"*"!==(t=t.trim())&&("."===t[0]?r.iconElement.classList.add(t.slice(1)):r.iconElement.style.backgroundImage=e.formatString("url({0})",t),n=t),r.iconElement.classList.remove("hidden")):r.iconElement.classList.add("hidden")}})},n}(e.RadioButton);e.ToggleButton=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"input",attrs:{class:"TextBox"}})},n.prototype.initEvents=function(){var n=this;t.prototype.initEvents.call(this),this.onTextChange=new e.Event,this.onRemoved.addHandler((function(){return n.onTextChange.removeAllHandlers()}),this);var r="",o=function(t){var o=e.createEventArgs(n,t);o.oldText=r;var i=n.value.toString();o.newText=i,n.onTextChange.invoke(o),n.onInput("text",n.value),n.onInput("value",n.value),r=i};this.domElement.addEventListener("change",(function(e){o(e)})),this.domElement.addEventListener("input",(function(e){n.notifyOnKeyDown&&o(e)}));var i=!!navigator.userAgent.match(/Trident\/7\./);this.domElement.addEventListener("keypress",(function(e){13===e.keyCode&&i&&o(e)}))},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.type="string",this.readonly=!1,this.placeholder=""},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("inputType",{getter:function(){return e.domElement.type},setter:function(t){e.domElement.type=t}}),this.defineProperty("text",{getter:function(){return e.domElement.value},setter:function(t){null==t&&(t=""),e.domElement.value=t},observable:!0}),this.defineProperty("value",{getter:function(){switch(e.type){case"string":return e.text;case"number":return parseFloat(e.text)||0;default:throw new Error("TextBox type value is not implemented.")}},setter:function(t){var n=typeof t;"number"!==n&&"boolean"!==n||(t=t.toString()),null==t&&(t=""),e.text=t},observable:!0}),this.defineProperty("type",{setter:function(t){switch(t){case"string":e.domElement.type="text";break;case"number":e.domElement.type="number";break;default:throw new Error("TextBoxType value is not implemented.")}},acceptedValues:["string","number"]}),this.defineProperty("min",{setter:function(t){return e.domElement.setAttribute("min",t.toString())}}),this.defineProperty("max",{setter:function(t){return e.domElement.setAttribute("max",t.toString())}}),this.defineProperty("step",{setter:function(t){return e.domElement.setAttribute("step",t.toString())}}),this.defineProperty("readonly",{setter:function(t){e.domElement.readOnly=!!t}}),this.defineProperty("placeholder",{getter:function(){return e.domElement.placeholder},setter:function(t){e.domElement.placeholder=t||""}})},n}(e.Element);e.TextBox=t}(xp||(xp={})),function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"textarea",attrs:{class:"TextArea TextBox",spellcheck:"false"}})},n}(e.TextBox);e.TextArea=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),n.prototype.getTemplate=function(){return document.createElement("div")},n.prototype.applyMarkup=function(e){var n={};for(var r in e)n[r]=e[r];if(n.html&&n.url||!n.html&&!n.url)throw new Error('One property, "html" or "url", must be specified.');n.html&&(this.html=n.html,delete n.html),n.url&&(this.url=n.url,delete n.url),t.prototype.applyMarkup.call(this,n)},n.prototype.defineProperties=function(){var n=this;t.prototype.defineProperties.call(this);var r=!1,o=!1,i=!1;this.defineProperty("html",{getter:function(){return n.domElement.outerHTML},setter:function(t){if(!i&&o)throw new Error("Unable to set HTML twice.");var r=e.Dom.create(t);if(1!==r.nodeType)throw new Error("Html control must have one root element.");n.domElement.parentNode&&n.domElement.parentNode.replaceChild(r,n.domElement),n.domElement=r,o=!0,n.initEvents()}}),this.defineProperty("url",{setter:function(e){if(r)throw new Error("Unable to set URL twice.");var t=new XMLHttpRequest;t.open("get",e),t.onreadystatechange=function(){4===t.readyState&&(r=!0,i=!0,n.html=t.responseText,i=!1)},t.send(null)}})},n}(e.Element);e.Html=t}(xp||(xp={})),function(e){var t=function(t){function n(n,r){var o=this;t.call(this,n),r&&r.forEach((function(e){return o.append(e)})),this.cascadeBy((function(t){if(t!==o&&t.name){if(t.name in o)throw new Error(e.formatString('Unable to set named child "{0}". Container\'s property is already defined.',t.name));o[t.name]=t}}))}return __extends(n,t),n.prototype.initElement=function(){this.children=[],t.prototype.initElement.call(this)},n.prototype.getContainerElement=function(){return this.domElement},n.prototype.__setRenderedState__=function(e){this.__isRendered__=e,this.children&&this.children.forEach((function(t){t.__setRenderedState__(e)})),e&&this.onRendered&&this.onRendered.invoke(this)},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("padding",{setter:function(t){return e.domElement.style.padding=t},getter:function(){return e.domElement.style.padding}})},n.prototype.append=function(e){this.insert(e,this.children.length)},n.prototype.prepend=function(e){this.insert(e,0)},n.prototype.insert=function(e,t){if(e.parent!==this||this.children.indexOf(e)!=t){if(t>this.children.length)throw new Error("Index was out or range.");var n=this.getContainerElement();if(e.parent===this){var r=this.children.indexOf(e),o=r<t?t+1:t;o===this.children.length?n.appendChild(e.domElement):n.insertBefore(e.domElement,n.children.item(o)),this.children.move(r,t)}else e.parent&&e.parent.detachChild(e),t===this.children.length?n.appendChild(e.domElement):n.insertBefore(e.domElement,n.children.item(t)),this.children.splice(t,0,e),e.__setParent__(this)}},n.prototype.detachChild=function(t){var n=this.children.indexOf(t);if(n<0)throw new Error("Element is not a child of this container.");this.children.splice(n,1),t.__setParent__(null),e.Dom.remove(t.domElement)},n.prototype.cascadeBy=function(e,t){if(void 0===t&&(t=!1),t&&!0==!!e(this))return this;for(var r=0;r<this.children.length;r++){if(!0==!!e(this.children[r]))return this.children[r];if(this.children[r]instanceof n){var o=this.children[r].cascadeBy(e,!1);if(null!=o)return o}}return null},n.prototype.find=function(e){return this.cascadeBy((function(t){return e(t)}))},n.prototype.findAll=function(e){var t=[];return this.cascadeBy((function(n){e(n)&&t.push(n)})),t},n.prototype.remove=function(){this.removeChildren(),t.prototype.remove.call(this)},n.prototype.removeChildren=function(){for(var e=this.children.length-1;e>=0;e--)this.children[e].remove();this.children=[]},n}(e.Element);e.Container=t}(xp||(xp={})),function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.setDefaults=function(){e.prototype.setDefaults.call(this),this.itemsIndent="none",this.scrollBar="both",this.wrapping="nowrap"},t.prototype.defineProperties=function(){var t=this;e.prototype.defineProperties.call(this),this.defineProperty("itemsIndent",{setter:function(e){switch(t.domElement.classList.remove("itemsIndent-05"),t.domElement.classList.remove("itemsIndent-1"),t.domElement.classList.remove("itemsIndent-2"),t.domElement.classList.remove("itemsIndent-4"),e){case"none":break;case"0.5em":t.domElement.classList.add("itemsIndent-05");break;case"1em":t.domElement.classList.add("itemsIndent-1");break;case"2em":t.domElement.classList.add("itemsIndent-2");break;case"4em":t.domElement.classList.add("itemsIndent-4");break;default:throw new Error("Unknown items indent value: "+e)}},acceptedValues:["none","0.5em","1em","2em","4em"]}),this.defineProperty("scrollBar",{setter:function(e){switch(t.domElement.classList.remove("scrollBar-None"),t.domElement.classList.remove("scrollBar-Horizontal"),t.domElement.classList.remove("scrollBar-Vertical"),t.domElement.classList.remove("scrollBar-Both"),e){case"none":t.domElement.classList.add("scrollBar-None");break;case"horizontal":t.domElement.classList.add("scrollBar-Horizontal");break;case"vertical":t.domElement.classList.add("scrollBar-Vertical");break;case"both":t.domElement.classList.add("scrollBar-Both");break;default:throw new Error("Unknown scroll bar value: "+e)}},acceptedValues:["none","horizontal","vertical","both"]}),this.defineProperty("wrapping",{setter:function(e){switch(t.domElement.classList.remove("wrapping-NoWrap"),t.domElement.classList.remove("wrapping-Wrap"),e){case"nowrap":t.domElement.classList.add("wrapping-NoWrap");break;case"wrap":t.domElement.classList.add("wrapping-Wrap");break;default:throw new Error("Unknown wrapping value: "+e)}},acceptedValues:["nowrap","wrap"]})},t}(e.Container);e.Stack=t}(xp||(xp={})),function(e){var t=function(t){function n(e,n){t.call(this,e,n)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"div",attrs:{class:"HBox"}})},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.contentAlign="left",this.itemsAlign="stretch"},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("contentAlign",{setter:function(t){switch(e.domElement.classList.remove("contentAlign-Left"),e.domElement.classList.remove("contentAlign-Center"),e.domElement.classList.remove("contentAlign-Right"),t){case"left":e.domElement.classList.add("contentAlign-Left");break;case"center":e.domElement.classList.add("contentAlign-Center");break;case"right":e.domElement.classList.add("contentAlign-Right");break;default:throw new Error("Unknown content alignment value: "+t)}},acceptedValues:["left","center","right"]}),this.defineProperty("itemsAlign",{setter:function(t){switch(e.domElement.classList.remove("itemsAlign-Top"),e.domElement.classList.remove("itemsAlign-Middle"),e.domElement.classList.remove("itemsAlign-Bottom"),e.domElement.classList.remove("itemsAlign-Stretch"),t){case"top":e.domElement.classList.add("itemsAlign-Top");break;case"middle":e.domElement.classList.add("itemsAlign-Middle");break;case"bottom":e.domElement.classList.add("itemsAlign-Bottom");break;case"stretch":e.domElement.classList.add("itemsAlign-Stretch");break;default:throw new Error("Unknown items alignment value: "+t)}},acceptedValues:["top","middle","bottom","stretch"]})},n}(e.Stack);e.HBox=t}(xp||(xp={})),function(e){var t=function(t){function n(e,n){t.call(this,e,n)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"div",attrs:{class:"VBox"}})},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.contentAlign="top",this.itemsAlign="stretch"},n.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("contentAlign",{setter:function(t){switch(e.domElement.classList.remove("contentAlign-Top"),e.domElement.classList.remove("contentAlign-Middle"),e.domElement.classList.remove("contentAlign-Bottom"),t){case"top":e.domElement.classList.add("contentAlign-Top");break;case"middle":e.domElement.classList.add("contentAlign-Middle");break;case"bottom":e.domElement.classList.add("contentAlign-Bottom");break;default:throw new Error("Unknown content alignment value: "+t)}},acceptedValues:["top","middle","bottom"]}),this.defineProperty("itemsAlign",{setter:function(t){switch(e.domElement.classList.remove("itemsAlign-Left"),e.domElement.classList.remove("itemsAlign-Center"),e.domElement.classList.remove("itemsAlign-Right"),e.domElement.classList.remove("itemsAlign-Stretch"),t){case"left":e.domElement.classList.add("itemsAlign-Left");break;case"center":e.domElement.classList.add("itemsAlign-Center");break;case"right":e.domElement.classList.add("itemsAlign-Right");break;case"stretch":e.domElement.classList.add("itemsAlign-Stretch");break;default:throw new Error("Unknown items alignment value: "+t)}},acceptedValues:["left","center","right","stretch"]})},n}(e.Stack);e.VBox=t}(xp||(xp={})),function(e){var t=function(t){function n(e){t.call(this,e),this.itemReplacementToken=!1,this.itemReplacementHandlers=[]}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"div",attrs:{class:"List VBox"}})},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.itemId="item"},n.prototype.defineProperties=function(){var n=this;t.prototype.defineProperties.call(this),this.defineProperty("items",{setter:function(t){if(n.removeReplacementHandlers(),n.removeChildren(),n.itemsRegistar.unsubscribeAll(),t&&n.itemCreator){if(t.forEach((function(e,t){n.addItem(t,e)})),e.isCollectionNotifier(t)){var r=t;n.itemsRegistar.subscribe(r.onCollectionChanged,(function(t){switch(t.action){case e.CollectionChangeAction.Attach:case e.CollectionChangeAction.Create:n.addItem(t.newIndex,t.newItem);break;case e.CollectionChangeAction.Detach:case e.CollectionChangeAction.Delete:var r=n.itemReplacementHandlers.filter((function(e){return e.item===t.oldItem}))[0];r.holder.onPropertyChanged.removeHandler(r.handler),n.itemReplacementHandlers.splice(n.itemReplacementHandlers.indexOf(r),1),n.children[t.oldIndex].remove();break;case e.CollectionChangeAction.Replace:n.itemReplacementToken||(n.children[t.newIndex].scope[n.itemId]=t.newItem);break;case e.CollectionChangeAction.Move:n.insert(n.children[t.oldIndex],t.newIndex);break;default:throw new Error("Not implemented.")}}),n)}if(e.isNotifier(t)){var o=function(e){};n.itemsRegistar.subscribe(t.onPropertyChanged,o,n)}}}}),this.defineProperty("itemCreator",{setter:function(){return n.items=n.items}})},n.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.itemsRegistar=new e.EventRegistrar},n.prototype.addItem=function(t,n){var r=this.itemCreator(n);r.name=e.createUuid(),r.useParentScope=!1,this.insert(r,t),r.scope=this.createItemScopeFrom(n)},n.prototype.createItemScopeFrom=function(t){var n=this,r={};r[this.itemId]=t;var o=new e.Scope(e.observable(r),this.scope),i={item:t,handler:function(e){if(e===n.itemId){var t=n.items.indexOf(i.item);if(t<0)throw new Error("Item does not belong to List items.");n.itemReplacementToken=!0,n.items[t]=i.holder[e],n.itemReplacementToken=!1,i.item=i.holder[e]}},holder:o};return i.holder.onPropertyChanged.addHandler(i.handler,this),this.itemReplacementHandlers.push(i),o},n.prototype.remove=function(){this.removeReplacementHandlers(),t.prototype.remove.call(this)},n.prototype.removeReplacementHandlers=function(){this.itemReplacementHandlers&&(this.itemReplacementHandlers.forEach((function(e){e.holder.onPropertyChanged.removeHandler(e.handler)})),this.itemReplacementHandlers=[])},n}(e.VBox);e.List=t}(xp||(xp={})),function(e){var t=function(t){function n(e,n){t.call(this,e,n)}return __extends(n,t),n.prototype.getTemplate=function(){var e=document.body;return e.classList.add("Window"),e.classList.add("VBox"),this.__setRenderedState__(!0),e},n.prototype.initElement=function(){if(t.prototype.initElement.call(this),n.instance)throw new Error("There is already another Window.");n.instance=this},n.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.title="XP Application"},n.prototype.defineProperties=function(){t.prototype.defineProperties.call(this),this.defineProperty("title",{getter:function(){return document.title},setter:function(e){return document.title=e},observable:!0})},n.prototype.showModal=function(t){if(this.tint||this.modal)throw new Error("Another modal is displayed.");this.tint=new e.ModalTint,this.tint.appendTo(this),this.modal=t,t.appendTo(this.tint)},n.prototype.closeModal=function(){this.modal.remove(),this.tint.remove(),this.modal=null,this.tint=null},n}(e.VBox);e.Window=t}(xp||(xp={})),function(e){var t=function(t){function n(e,n){t.call(this,e,n)}return __extends(n,t),n.prototype.show=function(){e.Window.instance.showModal(this)},n.prototype.close=function(){(!this.onClose||this.onClose())&&e.Window.instance.closeModal()},n.prototype.getTemplate=function(){return e.Dom.create({tag:"div",attrs:{class:"Modal VBox"}})},n}(e.VBox);e.Modal=t;var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.getTemplate=function(){return e.Dom.create({tag:"div",attrs:{class:"ModalTint"}})},n}(e.Container);e.ModalTint=n}(xp||(xp={})),function(e){var t=function(t){function n(n,r,o){var i=this;(t.call(this,{padding:"1em 1.5em",width:"32em",margin:"-15% 0 0 0"}),void 0!==r)&&new e.Label({text:r,style:"title",margin:"0 0 1rem 0"}).appendTo(this);void 0!==n&&new e.Label({margin:"0 0 2em 0",text:n,style:"message"}).appendTo(this);o=o||{OK:function(){}};var s=new e.HBox({contentAlign:"right"});for(var a in o)!function(t){new e.Button({text:t,minWidth:"4em",init:function(e){return e.onClick.addHandler((function(){o[t](),i.close()}))}}).appendTo(s)}(a);s.appendTo(this)}return __extends(n,t),n.show=function(e,t,r){new n(e,t,r).show()},n}(e.Modal);e.MessageBox=t}(xp||(xp={})),function(e){var t=function(t){function r(e){var n=this;t.call(this),e.forEach((function(e){return n.createMenuItem(e)}))}return __extends(r,t),r.prototype.getTemplate=function(){return e.Dom.create({tag:"div",attrs:{class:"ContextMenu VBox"}})},r.prototype.createMenuItem=function(e){new n(e,this).appendTo(this)},r.prototype.show=function(t,n){var r=this,o=function(e){r.remove(),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",i)},i=function(e){27===e.keyCode&&o(e)};window.addEventListener("mousedown",o),window.addEventListener("keydown",i),this.domElement.style.left=t+"px",this.domElement.style.top=n+"px",e.Window.instance.append(this);var s=this.domElement.getBoundingClientRect(),a=document.documentElement.getBoundingClientRect();s.right>a.right&&(this.domElement.style.left=t-s.width+"px"),s.bottom>a.bottom&&(this.domElement.style.top=n-s.height+"px")},r.show=function(e,t,n){new r(n).show(e,t)},r}(e.VBox);e.ContextMenu=t;var n=function(t){function n(e,n){t.call(this),this.menu=n,this.initItemData(e)}return __extends(n,t),n.prototype.initItemData=function(t){var n=this;t.icon&&("."===t.icon[0]?this.iconElement.classList.add(t.icon.slice(1)):this.iconElement.style.backgroundImage=e.formatString("url({0})",t.icon)),t.key&&(this.keyElement.textContent=t.key),t.disabled&&(this.enabled=!1),this.textElement.textContent=t.text,this.onMouseDown.addHandler((function(e){e.domEvent.stopPropagation(),n.menu.remove(),t.action()}),this)},n.prototype.getTemplate=function(){var t=e.Dom.create({tag:"span",attrs:{class:"ContextMenuItem",role:"button"},children:[{tag:"span",attrs:{class:"wrapper"},children:[{tag:"span",attrs:{class:"icon"}},{tag:"span",attrs:{class:"text"}},{tag:"span",attrs:{class:"key"}}]}]});return this.iconElement=e.Dom.select(".icon",t),this.textElement=e.Dom.select(".text",t),this.keyElement=e.Dom.select(".key",t),t},n}(e.Element)}(xp||(xp={})),function(e){!function(t){t.assert=function(t){var n=typeof t;if("boolean"!==n)throw new Error("Assert statement must be boolean but not "+n+".");if(!0!==t)throw new Error(e.formatString("Statement is wrong."))},t.assertEqual=function(t,n){if(t!==n)throw new Error(e.formatString('"{0}" is not equal to "{1}".',t,n))}}(e.Tests||(e.Tests={}))}(xp||(xp={}));