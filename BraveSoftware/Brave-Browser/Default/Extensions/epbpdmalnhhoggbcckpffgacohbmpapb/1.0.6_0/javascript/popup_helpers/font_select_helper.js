var DarkReader,__extends=this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o};!function(t){!function(t){var e=function(t){function e(e){var n=this;t.call(this,e,[new xp.HBox({style:"fontSelectLine"},[new xp.TextBox({style:"fontSelectTextBox",flex:"stretch",init:function(t){return n.textBox=t},notifyOnKeyDown:!0,onTextChange:function(t){return n.scrollToItemByText(t.newText)}}),new xp.Button({style:"fontSelectTick iconButton",flex:"none",icon:".down",init:function(t){return n.tick=t},onClick:function(t){n.isListExpanded?n.collapseList():n.scrollToItemByText(n.textBox.text)}})]),new xp.VBox({style:"fontList collapsed",flex:"stretch",init:function(t){return n.fontList=t}})]),this.onClick.addHandler((function(t){return t.domEvent.stopPropagation()})),this.outerClickHandler=function(){return n.collapseList()}}return __extends(e,t),e.prototype.getTemplate=function(){var e=t.prototype.getTemplate.call(this);return e.classList.add("FontSelect"),e},e.prototype.setDefaults=function(){t.prototype.setDefaults.call(this),this.fonts=[]},e.prototype.defineProperties=function(){var e=this;t.prototype.defineProperties.call(this),this.defineProperty("fonts",{setter:function(t){e.areFontsRendered=!1}}),this.defineProperty("selectedFont",{setter:function(t){e.textBox.text=t}})},Object.defineProperty(e.prototype,"isListExpanded",{get:function(){return!this.fontList.domElement.classList.contains("collapsed")},enumerable:!0,configurable:!0}),e.prototype.expandList=function(t){var e=this,n=function(){e.fontList.domElement.classList.remove("collapsed"),window.addEventListener("click",e.outerClickHandler),t&&t()};this.areFontsRendered?n():this.renderFonts(this.fonts,n)},e.prototype.collapseList=function(){this.fontList.domElement.classList.add("collapsed"),window.removeEventListener("click",this.outerClickHandler)},e.prototype.onPickFont=function(t){this.collapseList(),this.onInput("selectedFont",t)},e.prototype.scrollToItemByText=function(t){var e=this,n=function(){var n;for(t=t.toLowerCase().trim(),n=0;n<e.fonts.length;n++)if(0===e.fonts[n].toLowerCase().indexOf(t)){var o=e.fontList.children.filter((function(t){return t.text===e.fonts[n]}))[0];o&&o.domElement.scrollIntoView(!0);break}};this.isListExpanded?n():this.expandList(n)},e.prototype.renderFonts=function(t,e){var n=this;this.domElement.classList.add("renderingFonts"),this.fontList.removeChildren(),t&&setTimeout((function(){t=t.slice(0);for(var o=0;o<t.length;o++)!function(t){n.fontList.append(new xp.Label({style:"fontItem",text:t,onClick:function(){return n.onPickFont(t)},init:function(e){return e.domElement.style.fontFamily=t}}))}(t[o]);setTimeout((function(){n.domElement.classList.remove("renderingFonts"),n.areFontsRendered=!0,e&&e()}),0)}),100)},e}(xp.VBox);t.FontSelect=e}(t.Popup||(t.Popup={}))}(DarkReader||(DarkReader={}));